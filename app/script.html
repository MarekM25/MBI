<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Poszukiwacz</title>
</head>
<body>
	<script>
	l = 8;
	var X = ["30313212132311110311322302310330", "33113031012133312023201322320122", "03031111101200320000313333310132"];
	//X = ["303132121323111103100111111110000001322302310330", "331130310111111111213331202000000003201322320122", "030311000000111111110011101200320000313333310132"];
	X = ["11320302012130313221303110223013302231131323212003130321233311001103",
     "02301322323010333203110301230101122100113200010001213102001102002321",
     "00012330232101113133313312322131322110012022213203230300201200003333",
     "02113112032300231030213230013033011321101111303301031330123110303010",
     "13233030100121231032212222303212333322312312301213120312330112301221"];
	
	
	var t = X.length;
	var n = X[0].length;
		
		function permute(n, isPrefix) {
			if (isPrefix) {
				var prefixLength = n.length;
				var result = parseInt(n,4) + 1;
				result = result.toString(4);
				while (result.length < prefixLength){
					result = "0" + result;
				}
				while (result.length < l){
					result = result + "0";
				}
				return result
			} else {
				var result = parseInt(n,4) + 1;
				result = result.toString(4);
				while (result.length < l){
					result = "0" + result;
				}
				return result
			}
		}
		
		function hamming(str1, str2) {
			var distance = 0;
			for (var i = 0; i < str1.length; i++) {
				if (str1.charCodeAt(i) != str2.charCodeAt(i)) {
					distance += 1;
				}
			}
			return distance;
		}
		
		function distance(X, word) {
			var j = word.length;
			var resultX = 0;
			var hammingDistanceWord;
			var hammingDistanceX;
			for (var k = 0; k < X.length; k++) {
				var resultWord = j;
				for (var i = 0; i < X[k].length - j; i++) {
					hammingDistanceWord = hamming(X[k].substring(i,j + i),word)
					if (resultWord > hammingDistanceWord) {
						resultWord = hammingDistanceWord;
					}
				}
				resultX += resultWord;
			}
			return resultX;
		}
		
		
		var iterator = 0;
		var best = l*t + 1;
		var median = "";
		var i = 1;
		var v = permute(-1, false);
		var prefix = "";
		var optimistic = 0;
		var current = 0;
		var prevV = -1;
		
		
		while (true){
			prevV = v;
			if (i < l) { 
				prefix = v.substring(0, i);
				optimistic = distance(X,prefix);
				//document.write("Comparing " + optimistic + " > " + best + "<br>");
				if (optimistic > best) {
					//document.write(prefix + " omijaj  <br>");
					v = permute(prefix, true);
					//i = 1;
					if (prevV > v) break;
					//document.write("pomiaj <br>");
					//document.write(v + " po <br>");
				} else {
					i += 1;
				}
			} else {
				current = distance(X,v);
				if (current < best) {
					best = current;
					median = v;
					document.write("Median = " + median + " score: " + best + "<br>");
				}
				v = permute(v,false);
				if (prevV > v) break;
				i = 1;
			}
		}
		

		
		
		//document.write(permute("0000003",true)+"<br>");
		//document.write(permute("0000002",true)+"<br>");
		//document.write(permute("000333",true)+"<br>");
		//document.write(permute("01330",false)+"<br>");
		
		//document.write(hamming("ACB","ACB"));
		
		//document.write(t + "<br>");
		//document.write(n + "<br>");
		//document.write(X + "<br>");
		
		
		
		
	</script>
</body>
</html>
